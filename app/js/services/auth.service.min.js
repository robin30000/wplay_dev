(function(){"use strict";angular.module("app").factory("AuthService",AuthService);AuthService.$inject=["$http","$q","REST"];function AuthService($http,$q,REST){var dataFactory={};dataFactory.login=function(user){var data={user:user,metodo:"login"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.register=function(user){var data={data:{captcha:user.three.captcha,segmento:user.segment,pNom:user.one.firstName,sNom:user.one.secondName,pApe:user.one.lastname,sApe:user.one.secondLastname,sexo:user.one.gender,tDoc:user.one.documentType,numDoc:user.one.identity,depart_exp:{depto_id:user.one.departmentExp},ciud_exp:{ciudad_id:user.one.city},fExp:user.one.date,fVence:user.one.duedate,nacionalidad:{id:user.two.country},depart_nac:{depto_id:user.two.departmentFrom},ciudad_nac:{ciudad_id:user.two.cityFrom},fnace:user.two.date,ciud_res:{ciudad_id:user.two.city},depart_res:{depto_id:user.two.department},codP:{id_codigo_postal:user.two.zipcode},dir:user.two.address,mail:user.three.email,cmail:user.three.emailc,movil:user.three.mobile,fijo:user.three.phone,t_and_c:user.three.tyc,referido:user.three.referred,clave_reg:user.three.password,confirma_clave_reg:user.three.passwordc}};return $http.post(REST.API+"validarRegistro.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.updateRegister=function(user_id,token,user){var data={data:{pNom:user.one.firstName,sNom:user.one.secondName,pApe:user.one.lastname,sApe:user.one.secondLastname,sexo:user.one.gender,tDoc:user.one.documentType,numDoc:user.one.identity,depart_exp:{depto_id:user.one.departmentExp},ciud_exp:{ciudad_id:user.one.city},fExp:user.one.date,fVence:user.one.duedate,nacionalidad:{id:user.two.country},depart_nac:{depto_id:user.two.departmentFrom},ciudad_nac:{ciudad_id:user.two.cityFrom},fnace:user.two.date,ciud_res:{ciudad_id:user.two.city},depart_res:{depto_id:user.two.department},codP:{id_codigo_postal:user.two.zipcode},dir:user.two.address,movil:user.two.mobile,fijo:user.two.phone,t_and_c:user.two.tyc,clave_reg:user.two.password,confirma_clave_reg:user.two.passwordc},token:token,usuario_id:user_id};return $http.post(REST.API+"validarUpdateRegistro.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.checkSession=function(){var data={metodo:"getSession"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){if(response.data.usuario==""){return $q.reject("error")}return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.getSession=function(){var data={metodo:"getSession"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.changePassword=function(idUser,tokenSession,currentPassword,newPassword){var data={data:{user_id:idUser,session_token:tokenSession,password:currentPassword,confirPass:newPassword,newPassword:newPassword},metodo:"password"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.logout=function(idUser){var data={metodo:"logout",user_id:idUser};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.getSaldo=function(idUser,tokenSession){var data={user_id:idUser,token:tokenSession,metodo:"saldo"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.getSafetyQuestions=function(idUser,tokenSession){var data={metodo:"preguntas"};return $http.post(REST.API+"bancosControllers.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.setSafetyQuestions=function(idUser,tokenSession,questionOne,questionTwo,questionThree){var data={user:{user_id:idUser,token:tokenSession,p1:questionOne.id,r1:questionOne.answer,p2:questionTwo.id,r2:questionTwo.answer,p3:questionThree.id,r3:questionThree.answer},metodo:"guarda_preguntas_seguridad"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.verifyAccount=function(mail){var data={email:mail,metodo:"valida_email_preregistro"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.forgetPassword=function(mail){var data={data:{email:mail},metodo:"recuperarClave"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};dataFactory.restorePassword=function(mail,pass,cPass,captcha){var data={data:{email:mail,pass:pass,cPass:cPass,captcha:captcha},metodo:"restorePassword"};return $http.post(REST.API+"userController.php",data).then(complete).catch(failed);function complete(response){return $q.when(response.data)}function failed(response){return $q.reject(response.data)}};return dataFactory}})();
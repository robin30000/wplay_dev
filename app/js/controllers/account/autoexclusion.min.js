(function(){"use strict";angular.module("app").controller("exclusionController",exclusionController);exclusionController.$inject=["$rootScope","$scope","$routeParams","$location","growl","AuthService","GameAccount","$uibModal"];function exclusionController($rootScope,$scope,$routeParams,$location,growl,AuthService,GameAccount,$uibModal){var vm=this;vm.activeTab=$routeParams.paramId;vm.items=["Límite de Apuestas","Límite tiempo de Juego","Límite de depósito","Cancelar Cuenta"];vm.currentTitle=vm.items[vm.activeTab-1];vm.cancel=[];vm.daybetLimit=null;vm.weekbetLimit=null;vm.monthbetLimit=null;vm.hasTimeLimit=false;vm.hasBetLimit=false;vm.hasBetLimitDeposit=false;init();function init(){betLimit();betLimitDeposit();timeLimit()}function betLimit(){GameAccount.getDataAutoExclusionTime($rootScope.id,$rootScope.tokenSession).then(function(data){vm.rangeDaybetLimit=data.dia;vm.rangeWeekbetLimit=data.semana;vm.rangeMonthbetLimit=data.mes});GameAccount.betLimit($rootScope.id,$rootScope.tokenSession).then(complete).catch(failed);function complete(data){if(data.state==1){vm.daybetLimit=data.datos.limite_diario;vm.weekbetLimit=data.datos.limite_semanal;vm.monthbetLimit=data.datos.limite_mensual;vm.betLimitDate=data.datos.fecha_fin;vm.hasBetLimit=true}}function failed(data){}}function betLimitDeposit(){GameAccount.getDataAutoExclusionLimitDeposit($rootScope.id,$rootScope.tokenSession).then(function(data){vm.rangeDaybetLimitDeposit=data.dia;vm.rangeWeekbetLimitDeposit=data.semana;vm.rangeMonthbetLimitDeposit=data.mes});GameAccount.betLimitDeposit($rootScope.id,$rootScope.tokenSession).then(complete).catch(failed);function complete(data){if(data.state==1){vm.dayLimitDeposit=data.datos.limite_diario;vm.weekLimitDeposit=data.datos.limite_semanal;vm.monthLimitDeposit=data.datos.limite_mensual;vm.LimitDepositDate=data.datos.fecha_fin;vm.hasBetLimitDeposit=true}}function failed(data){}}function timeLimit(){GameAccount.getDataAutoExclusionDay($rootScope.id,$rootScope.tokenSession).then(function(data){vm.rangetimeLimit=data.dia});GameAccount.timeLimit($rootScope.id,$rootScope.tokenSession).then(complete).catch(failed);function complete(data){if(data.state===1){vm.hasTimeLimit=true;vm.dayHasTimeLimit=data.datos.dias;vm.timeLimit=data.datos.fecha_fin}}function failed(data){}}vm.savebetLimit=function savebetLimit(){GameAccount.updatebetLimit($rootScope.id,$rootScope.tokenSession,vm.betLimitPassword,vm.daybetLimit,vm.weekbetLimit,vm.monthbetLimit).then(complete).catch(failed);function complete(data){var config={referenceId:1};if(data.state==1){growl.success(data.msg,config);betLimit()}else{if(data.state==99){$location.path("/")}else{growl.error(data.msg,config)}}}function failed(data){}};vm.savebetLimitDeposit=function savebetLimitDeposit(){GameAccount.updatebetLimitDeposit($rootScope.id,$rootScope.tokenSession,vm.betLimitDepositPassword,vm.dayLimitDeposit,vm.weekLimitDeposit,vm.monthLimitDeposit).then(complete).catch(failed);function complete(data){var config={referenceId:1};if(data.state==1){growl.success(data.msg,config);betLimitDeposit()}else{if(data.state==99){$location.path("/")}else{growl.error(data.msg,config)}}}function failed(data){}};vm.savetimeLimit=function savetimeLimit(){GameAccount.setTimeLimit($rootScope.id,$rootScope.tokenSession,vm.timeLimitPassword,vm.timeLimit).then(complete).catch(failed);function complete(data){var config={referenceId:1};if(data.state==1){growl.success(data.msg,config);timeLimit()}else{if(data.state==99){$location.path("/")}else{growl.error(data.msg,config)}}}function failed(data){}};vm.cancelAccount=function cancelAccount(){GameAccount.cancelAccount($rootScope.id,$rootScope.tokenSession,vm.cancel.password,vm.cancel.answer,vm.cancel.confirm).then(complete).catch(failed);function complete(data){var config={referenceId:1};if(data.state==1){growl.success(data.msg,{referenceId:1,onclose:function(){AuthService.logout().then(function(data){$rootScope.authenticated=false;$location.path("/")})}})}else{if(data.state==99){$location.path("/")}else{growl.error(data.msg,config)}}}function failed(data){}};vm.selectTab=function selectTab(tab){vm.activeTab=tab;vm.currentTitle=vm.items[tab-1]};vm.aumentLimit=function aumentLimit(){var modalInstance=$uibModal.open({ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/views/aumentLimits.modal.html",controller:"aumentLimitsController",controllerAs:"aumentLimits",size:"lg"});modalInstance.result.then(function(result){vm.stepThree.tyc=result},function(){console.log("failed")})}}angular.module("app").controller("aumentLimitsController",aumentLimitsController);aumentLimitsController.$inject=["$rootScope","$scope","$sce","$uibModalInstance","GameInfo","GameAccount","$timeout","growl"];function aumentLimitsController($rootScope,$scope,$sce,$uibModalInstance,GameInfo,GameAccount,$timeout,growl){var vm=this;init();function init(){betLimitDeposit()}function betLimitDeposit(){GameAccount.getDataAutoExclusionLimitDeposit($rootScope.id,$rootScope.tokenSession).then(function(data){vm.rangeDaybetLimitDeposit=data.dia;vm.rangeWeekbetLimitDeposit=data.semana;vm.rangeMonthbetLimitDeposit=data.mes})}vm.savebetLimitDeposit=function savebetLimitDeposit(){GameAccount.updatebetLimitDepositPet($rootScope.id,$rootScope.tokenSession,vm.betLimitDepositPassword,vm.dayLimitDeposit,vm.weekLimitDeposit,vm.monthLimitDeposit).then(complete).catch(failed);function complete(data){console.log(data);var config={referenceId:1};if(data.state==1){$uibModalInstance.close();growl.success(data.msg);$timeout(function(){$route.reload()},6e3)}else{$uibModalInstance.close();growl.error(data.msg);$timeout(function(){$route.reload()},6e3)}}function failed(data){}};vm.close=function(){$uibModalInstance.close();$route.reload()}}})();
(function(){"use strict";angular.module("app").controller("inboxController",inboxController);inboxController.$inject=["$rootScope","$scope","$uibModal","GameAccount","filterFilter"];function inboxController($rootScope,$scope,$uibModal,GameAccount,filterFilter){var vm=this;vm.messages=[];vm.currentPage=1;vm.totalItems=0;vm.entryLimit=10;vm.noOfPages=0;init();function init(){GameAccount.getMessages($rootScope.id,$rootScope.tokenSession).then(complete).catch(failed);function complete(data){vm.messages=data;vm.totalItems=data.length;vm.noOfPages=Math.ceil(vm.totalItems/vm.entryLimit)}function failed(data){console.log(data)}}vm.open=function(message){GameAccount.readMessage($rootScope.id,$rootScope.tokenSession,message.id_message).then(function(data){message.leido=1}).catch(function(data){console.log(data)});var modalInstance=$uibModal.open({ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/views/message.modal.html",controller:"messageController",controllerAs:"message",resolve:{data:function(){return message}}});modalInstance.result.then(function(){console.log("ok")},function(){console.log("failed")})};$scope.$watch(function(){return vm.search},function(newVal,oldVal){if(newVal){vm.filtered=filterFilter(vm.messages,newVal);vm.totalItems=vm.filtered.length;vm.noOfPages=Math.ceil(vm.totalItems/vm.entryLimit);vm.currentPage=1}},true)}angular.module("app").controller("messageController",messageController);messageController.$inject=["$rootScope","$scope","$uibModalInstance","data"];function messageController($rootScope,$scope,$uibModalInstance,data){var vm=this;vm.header=data.asunto;vm.from=data.remitente;vm.body=data.texto;vm.date=data.fecha;vm.close=function(){$uibModalInstance.close()}}})();